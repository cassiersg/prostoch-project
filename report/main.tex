\documentclass[english,DIV=13]{scrartcl}

\input{lib.tex}

% Definition to put a bar under a letter/word (to use with matrix)
\usepackage{accents}
\newcommand{\ubar}[1]{\underaccent{\bar}{#1}}
\newcommand{\uvec}[1]{\ubar{#1}}
\newcommand{\umatrix}[1]{\ubar{\ubar{#1}}}

\titlehead{}
\subject{LINMA 1731 --- Stochastic processes}
\title{Bearings-only tracking problem}
\subtitle{}
\author{\textsc{Cassiers} GaÃ«tan \and \textsc{Losseau} Bruno}
\date{\today}

\begin{document}
\maketitle


\section*{Question 1}
\subsection*{Deriving $\umatrix{F}$ and $\uvec{U}$}

We start by studying the making a discretization of a movemement process in 1D, with the
variable $x(t)$. If we denode $x_k = x(Tk)$ (with $T$ a given discretization step), we
get
\begin{align*}
    x_{k+1} &= x_k + T\dot{x}_k + \int_{Tk}^{T(k+1)}\int_{Tk}^{t}\ddot{x}(t)\dif t\dif t' \\
    \dot{x}_{k+1} &=  \dot{x}_k + \int_{Tk}^{T(k+1)}\dot{x}(t)\dif t.
\end{align*}
This is a simple discrete-time state model, if we consider that the terms which depends of $\ddot{x}$
are an input signal.
We can generalize this equation to the relative state vector $\uvec{x} = \uvec{x}^t - \uvec{x}^o$:
\[\uvec{x}_{k+1} = \umatrix{F}\uvec{x}_k - \uvec{U}_{k,k+1} + \uvec{\epsilon}_k\]
with
\begin{itemize}
    \item The matrix
        \[\umatrix{F} =
        \begin{pmatrix}
            1 & 0 & T & 0 \\
            0 & 1 & 0 & T \\   
            0 & 0 & 1 & 0 \\
            0 & 0 & 0 & 1   
        \end{pmatrix}
        \]
    \item $\uvec{\epsilon}_k$ the variation of position and of velocity of the target caused by the
acceleration of the target,
    \item $\uvec{U}_{k,k+1}$ the variation of position and velocity of
the observer caused by the acceleration of the observer.
\end{itemize}

\subsection*{Deriving $h(\ubar{x})$}
Following its definition given in the statement and unsing the notation $\uvec{x}(i)$
for the $i$-th element of the vector $\uvec{x}$:
\begin{align*}
    h(\uvec{x}_k) &= \text{atan2}(\uvec{x}_k(1), \uvec{x}_k(2)) \\
    &= \begin{cases}
        \arctan\frac{\uvec{x}_k(1)}{\uvec{x}_k(2)} & \text{if $\uvec{x}_k(2) > 0$} \\
        \arctan\frac{\uvec{x}_k(1)}{\uvec{x}_k(2)}+\pi & \text{if $\uvec{x}_k(2) < 0$ and $\uvec{x}_k(1) \geq 0$} \\
        \arctan\frac{\uvec{x}_k(1)}{\uvec{x}_k(2)}-\pi & \text{if $\uvec{x}_k(2) < 0$ and $\uvec{x}_k(1) < 0$} \\
        0 & \text{if $\uvec{x}_k(2) \geq 0$ and $\uvec{x}_k(1) = 0$} \\
        \pi & \text{if $\uvec{x}_k(2) < 0$ and $\uvec{x}_k(1) = 0$}
    \end{cases}
\end{align*}


\section*{Question 2}

Results for question 2:
\begin{center}
   \includegraphics[width=0.49\textwidth]{img/q2_1.eps}
   \includegraphics[width=0.49\textwidth]{img/q2_2.eps}
   \includegraphics[width=0.49\textwidth]{img/q2_3.eps}
   \includegraphics[width=0.49\textwidth]{img/q2_4.eps}
\end{center}


\section*{Question 3}
\begin{figure}
   \caption{\label{q3a} }
   \includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{q3a.png}
\end{figure}
\begin{figure}
\begin{center}
   \caption{\label{q3b} }
   \includegraphics[width=10cm,height=\textheight,keepaspectratio]{q3b.png}
\end{center}
\end{figure}


\section*{Question 4}
\begin{figure}
   \caption{\label{q4} }
   \includegraphics[width=\textwidth,height=\textheight,keepaspectratio]{q4.png}
\end{figure}

\section*{Question 5}


\section*{Question 6}


\section*{Codes matlab}
\lstinputlisting{../matlab/q2.m}


\end{document}
